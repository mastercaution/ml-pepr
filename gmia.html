

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Generalized Membership Inference Attack (Direct) &mdash; ML-PePR alpha documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Robustness Attacks" href="robustness_attacks.html" />
    <link rel="prev" title="Membership Inference Attack" href="mia.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ML-PePR
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start_guide.html">Quick-Start Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="privacy_attacks.html">Privacy Attacks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mia.html">Membership Inference Attack</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Generalized Membership Inference Attack (Direct)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="robustness_attacks.html">Robustness Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ML-PePR</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="privacy_attacks.html">Privacy Attacks</a> &raquo;</li>
        
      <li>Generalized Membership Inference Attack (Direct)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/gmia.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="generalized-membership-inference-attack-direct">
<h1>Generalized Membership Inference Attack (Direct)<a class="headerlink" href="#generalized-membership-inference-attack-direct" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="pepr.privacy.gmia.DirectGmia">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pepr.privacy.gmia.</span></code><code class="sig-name descname"><span class="pre">DirectGmia</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attack_alias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attack_pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_models</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia" title="Permalink to this definition">¶</a></dt>
<dd><p>Direct Generalized Membership Inference Attack (d-GMIA)</p>
<p>Attack-Steps:</p>
<ol class="arabic simple">
<li><p>Create mapping of records to reference models.</p></li>
<li><p>Train the reference models.</p></li>
<li><p>Generate intermediate models.</p></li>
<li><p>Extract reference high-level features.</p></li>
<li><p>Extract target high-level features.</p></li>
<li><p>Compute pairwise distances between reference and target high-level
features.</p></li>
<li><p>Determine potential vulnerable target records.</p></li>
<li><p>Infer log losses of reference models.</p></li>
<li><p>Infer log losses of target model.</p></li>
<li><p>Sample reference losses, approximate empirical cumulative distribution
function, smooth ecdf with piecewise cubic interpolation.</p></li>
<li><p>Determine members and non-members with left-tailed hypothesis test.</p></li>
<li><p>Evaluate the attack results.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attack_alias</strong> (<em>str</em>) – Alias for a specific instantiation of the gmia.</p></li>
<li><p><strong>attack_pars</strong> (<em>dict</em>) – <p>Dictionary containing all needed attack parameters:</p>
<ul>
<li><p>number_classes (int): Number of different classes the target model
predict.</p></li>
<li><p>number_reference_models (int): Number of reference models to be trained.</p></li>
<li><p>reference_training_set_size (int): Size of the trainings set for each
reference model.</p></li>
<li><p>create_compile_model (function): Function that returns a compiled
TensorFlow model (typically identical to the target model) used in the
training of the reference models.</p></li>
<li><p>reference_epochs (int): Number of training epochs of the reference models.</p></li>
<li><p>reference_batch_size (int): Batch size used in the training of the
reference models.</p></li>
<li><p>hlf_metric (str): Metric (typically ‘cosine’) used for the distance
calculations in the high-level feature space. For valid metrics see
documentation of sklearn.metrics.pairwise_distances.</p></li>
<li><p>hlf_layer_number (int): If value is n, the n-th layer of the model
returned by create_compile_model is used to extract the high-level feature
vectors.</p></li>
<li><p>neighbor_threshold (float): If distance is smaller then the neighbor
threshold the record is selected as target record.</p></li>
<li><p>probability_threshold (float): For details see section 4.3 from the paper.</p></li>
<li><p>number_target_records (int): If set, the selection algorithm performs
<cite>max_search_rounds</cite>, to find a <cite>neighbor_threshold</cite>, that leads to a finding
of <cite>n_targets</cite> target records. These target records are most vulnerable with
respect to our selection criterion.</p></li>
<li><p>max_search_rounds (int): If <cite>number_target_records</cite> is given, maximal
<cite>max_search_rounds</cite> are performed to find <cite>number_target_records</cite> of potential
vulnerable target records.</p></li>
</ul>
</p></li>
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – Dataset with all training samples used in the given pentesting setting.</p></li>
<li><p><strong>labels</strong> (<em>numpy.ndarray</em>) – Array of all labels used in the given pentesting setting.</p></li>
<li><p><strong>data_conf</strong> (<em>dict</em>) – <p>Dictionary describing which record-indices are used to train the reference
models, the target model(s) and which are used for the evaluation of the
attack.</p>
<ul>
<li><p>reference_indices (list): List of indices describing which of the records
from data are used to train the reference models.</p></li>
<li><p>target_indices (list): List of indices describing which of the records
from data were used to train the target model(s).</p></li>
<li><p>evaluation_indices (list): List of indices describing which of the records
from data are used to evaluate the attack. Typically these are to one half
records used to train the target models and one half neither used to train
the target model(s) or the reference models.</p></li>
<li><p>record_indices_per_target (numpy.ndarray): n*m array describing for all n
target models which m indices where used in the training.</p></li>
</ul>
</p></li>
<li><p><strong>target_models</strong> (<em>iterable</em>) – List of target models which should be tested.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="pepr.privacy.gmia.DirectGmia.attack_alias">
<code class="sig-name descname"><span class="pre">attack_alias</span></code><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.attack_alias" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for a specific instantiation of the attack class.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pepr.privacy.gmia.DirectGmia.attack_pars">
<code class="sig-name descname"><span class="pre">attack_pars</span></code><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.attack_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary containing all needed parameters fo the attack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pepr.privacy.gmia.DirectGmia.data">
<code class="sig-name descname"><span class="pre">data</span></code><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Dataset with all training samples used in the given pentesting setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pepr.privacy.gmia.DirectGmia.labels">
<code class="sig-name descname"><span class="pre">labels</span></code><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of all labels used in the given pentesting setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pepr.privacy.gmia.DirectGmia.data_conf">
<code class="sig-name descname"><span class="pre">data_conf</span></code><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.data_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary describing the data configuration of the given pentesting
setting.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pepr.privacy.gmia.DirectGmia.target_models">
<code class="sig-name descname"><span class="pre">target_models</span></code><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.target_models" title="Permalink to this definition">¶</a></dt>
<dd><p>List of target models which should be tested.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>iterable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pepr.privacy.gmia.DirectGmia.attack_results">
<code class="sig-name descname"><span class="pre">attack_results</span></code><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.attack_results" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li><p>selected_target_records (numpy.ndarray): List of record indices selected as
potential vulnerable.</p></li>
<li><p>neighbor_threshold (float): If distance is smaller then the neighbor threshold
the record is selected as target record.</p></li>
<li><p>probability_threshold (float): For details see section 4.3 from the original
publication.</p></li>
<li><p>reference_inferences (numpy.ndarray): Array of log losses of the predictions
on the reference models.</p></li>
<li><p>target_inferences (numpy.ndarray): Array of log losses of the predictions on
the target models.</p></li>
<li><p>used_target_records (numpy.ndarray): Target records finally used for the
attack.</p></li>
<li><p>pchip_references (list): Interpolated ecdfs of sampled log losses.</p></li>
<li><p>ecdf_references (list): Estimated CDF of sampled log losses.</p></li>
<li><p>tp_list (list): True positives per cut-off-p-value (0, 0.01, 0.02, …, 1) and
target model.</p></li>
<li><p>fp_list (list): False positives per cut-off-p-value and target model.</p></li>
<li><p>fn_list (list): False negatives per cut-off-p-value and target model.</p></li>
<li><p>tn_list (list): True negatives per cut-off-p-value and target model.</p></li>
<li><p>accuracy_list (list): Attack accuracy per cut-off-p-value and target model.</p></li>
<li><p>recall_list (list): Attack recall per cut-off-p-value and target model.</p></li>
<li><p>overall_accuracy (list): Attack accuracy averaged over all target models per
cut-off-p-value.</p></li>
<li><p>overall_recall (list): Attack recall averaged over all target models per
cut-off-p-value.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<p>Implementation of the direct gmia from Long, Yunhui and Bindschaedler, Vincent and
Wang, Lei and Bu, Diyue and Wang, Xiaofeng and Tang, Haixu and Gunter, Carl A and
Chen, Kai (2018). Understanding membership inferences on well-generalized learning
models. arXiv preprint arXiv:1802.04889.</p>
<dl class="py method">
<dt id="pepr.privacy.gmia.DirectGmia.create_attack_report">
<code class="sig-name descname"><span class="pre">create_attack_report</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gmia_report'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.create_attack_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an attack report just for the given attack instantiation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path</strong> (<em>str</em>) – Path to save the tex and pdf file of the attack report.</p></li>
<li><p><strong>pdf</strong> (<em>bool</em>) – If set, generate pdf out of latex file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pepr.privacy.gmia.DirectGmia.create_attack_section">
<code class="sig-name descname"><span class="pre">create_attack_section</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.create_attack_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a report section for the gmia attack instantiation.</p>
</dd></dl>

<dl class="py method">
<dt id="pepr.privacy.gmia.DirectGmia.run">
<code class="sig-name descname"><span class="pre">run</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pepr.privacy.gmia.DirectGmia.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the direct generalized membership inference attack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_path</strong> (<em>str</em>) – <p>If path is given, the following (partly computational expensive)
intermediate results are saved to disk:</p>
<ul>
<li><p>The mapping of training-records to reference models</p></li>
<li><p>The trained reference models</p></li>
<li><p>The reference high-level features</p></li>
<li><p>The target high-level features</p></li>
<li><p>The matrix containing all pairwise distances between the reference- and
target high-level features.</p></li>
</ul>
</p></li>
<li><p><strong>load_pars</strong> (<em>dict</em>) – <p>If this dictionary is given, the following computational intermediate
results can be loaded from disk.</p>
<ul>
<li><p>records_per_reference_model (str) : Path to the mapping.</p></li>
<li><p>reference_models (list) : List of paths to the reference models.</p></li>
<li><p>pairwise_distance_hlf_&lt;hlf_metric&gt; (str) :  Path to the pairwise distance
matrix between the reference- and target high-level features using a
hlf_metric (e.g. cosine).</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="robustness_attacks.html" class="btn btn-neutral float-right" title="Robustness Attacks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mia.html" class="btn btn-neutral float-left" title="Membership Inference Attack" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Institute for IT-Security (University of Luebeck).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>